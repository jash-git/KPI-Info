(function () {
    
        setCookie = function(cname, cvalue, seconds) {
            var d = new Date();
            d.setTime(d.getTime() + (seconds*1000));
            var expires = "expires="+ d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }
        getCookie = function(cname) {
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for(var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }        
        $.fn.getBnextDialog = function(cb, flag) {    
            var $html = $(this);
            var visible = flag ? 'hidden': 'visible';
            var $iframe = $('<div />',{
                  'class':'bnextDialogFrame',
                  'css':    {
                        'visibility': visible,
                        'display': 'block',
                        'position': 'fixed',
                        'top': 0,
                        'left': 0,
                        'width': '100%',
                        'bottom': 0,
                        'z-index': 999999        
                    }
              });          
              var $btn = $('<a><i class="bx_icon">X</i></a>').click(function(){
                if(cb) {
                    cb();
                }
              });        
              var $btnC = $('<div />',{
                  'class':'bx_btn',
                  'html': $btn
              })
              var $wrapper = $('<div />',{
                  'class':'bx_wrapper',
                  'html':[$btnC,$html]
              });                
              var $c = $('<div />',{
                  'class':'bnextDialog',
                  'html': $wrapper
              });      
              $iframe.append($c);
             return $iframe; 
        }
  
        var obj_ads = {"width":"100%","height":"auto","uuid":"af988c8e-c92b-e9351ee0","css":"<link id=\"bnextmedia_css\" href=\"https:\/\/pumpkin.bnextmedia.com.tw\/css\/style.css\" rel=\"stylesheet type=\"text\/css\" \/>","style":"","html":"<style type=\"text\/css\">\np { margin:0;padding:0;}\n.mtaa { bottom: 0; width: 100%;left: 0;}\n.show.mtaa {\n\t  bottom: 70px; \n\t  background-color:rgba(50, 49, 72, 0.9); \n\t  display: block; \n\t  width: 100%; \n\t  height: 60px; \n\t  color:#fff; \n\tz-index: 1000;\n    -webkit-animation: mymove 1s;  \n    -webkit-animation-iteration-count: 1; \n    animation: mymove 1s;\n    animation-iteration-count: 1;\n}\t\n\n.aa_close .mtaa {\n\tbottom: 0;\n\t}\n.mtaa02{\n\twidth: 100%;\n    max-width: 1380px;\n    margin: auto;\n    text-align: center;\n    line-height: 60px;}\n\t\t  \n.effect{\n\tposition: fixed;\n\t-webkit-transform: translate(0, 70px);\n\t-moz-transform: translate(0, 70px);\n\t-o-transform: translate(0, 70px);\n\ttransform: translate(0, 70px);\n\t-webkit-transition: -webkit-transform 1s linear;\n\t-moz-transition: -moz-transform 1s linear;\n\t-o-transition: -o-transform 1s linear;\n\ttransition: transform 1s linear;\n\t}\t  \n\n@-webkit-keyframes mymove {\n    from {bottom: 0;}\n    to {bottom: 70px;}\n}\n\n@keyframes mymove {\n    from {bottom: 0;}\n    to {bottom: 70px;}\n}\t\n.closeaa {\n\tposition: absolute;\n\tfont-size: 2em;\n\tfont-weight: lighter;\n\theight: 100%;\n\toverflow: hidden;\n\tright: 0;\n\tbackground-color: #000028;\n\ttext-align: center;\n\tborder: 0;\n\tcolor: #fff;\n\tpadding: 10px;}\n.closeaa:hover{color: #ff5500;}\nbutton{ padding: 0; }\n.flexbox {\n      display:flex;\n      align-items:center;\n      justify-content:center;\n      width:100%;\n      height:60px;\n\t  box-shadow: 0 -3px 10px 0 rgba(0,0,0,.15);\n  }\n\n\n.aatitle{\n\tdisplay: inline-block;\n    font-size: 1.2em;\n    font-weight: 700;\n    color: #fff;}\t\n\t\n.but01{\n\tdisplay: inline-block;\n        background-color: #fff;\n\tcolor:#000028;\n    padding: 5px 10px;\n    border-radius: 6px;\n    font-size: 15px;\n    line-height: 1.2;\n\tmargin:0 10px;\n\t}\t\n.aatitle.mobile {\nfont-size: 18px;\n}\n<\/style>\n<div class=\"mtaa effect hidden-xs\">\n<button type=\"button\" class=\"closeaa\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">\u00d7<\/span><\/button>\n<a href=\"https:\/\/www.shopbnextmedia.com\/pages\/%E7%B6%93%E7%90%86%E4%BA%BA%E6%96%B0%E6%9B%B8%E5%BF%AB%E8%AE%80?utm_source=web_mt&utm_medium=aabar&utm_campaign=\u65b0\u66f8\u5feb\u8b80\">\n<div class=\"flexbox\">\n<p class=\"aatitle hidden-sm hidden-xs\">6 \u500b\u6708\u7684\u77ed\u5f71\u97f3\u8aaa\u66f8\uff01\u4e00\u6b21\u638c\u63e1 2018 \u5fc5\u8b80\u5546\u7ba1\u8a71\u984c\uff0c\u8f15\u9b06\u990a\u6210\u8b80\u66f8\u597d\u7fd2\u6163<\/p>\n<span class=\"but01\">\u5feb\u4f86\u9ad4\u9a57<\/span>\n<\/div>\n<\/a>\n<\/div>\n<script>\n\n(function(){\n\nvar now = new Date().getTime();\n\nvar last = localStorage.getItem('_pumpkin_aabar_pc');\nif( now > last) {\nvar expire = now + (1000*300);\nlocalStorage.setItem('_pumpkin_aabar_pc', expire);\n} else {\nreturn;\n}\n\n\nvar $c =$(\".mtaa\",window.parent.document);\nvar $btn =$c.find('.closeaa');\nvar handle = function(){\nvar s = ($(this).scrollTop() \/ $(window.parent.document).height()) * 100;\nif(s > 20) {\n$c.addClass('show');\t\n$(window.parent).unbind('scroll',handle);\n }\n\n}\n$(window.parent).bind('scroll',handle).trigger('scroll');\n$c.bind('click',function(){\n$c.removeClass('show');\n$c.remove();\n});\n}());\n<\/script>","terms":"all,id_56163,id_56221,id_56662,id_56651,id_56549,id_55286,id_54993,id_54795,id_53900,id_54463,id_56611,id_51322,id_56679","trace":"<img src=\"https:\/\/pumpkin.bnextmedia.com.tw\/feed\/trace\/881?act=exposure\" style='display:none;' \/>","click":"<img src=\"https:\/\/pumpkin.bnextmedia.com.tw\/feed\/trace\/881?act=click\" style='display:none;' \/>","is_native":true,"is_dialog":false,"expired_time":0};
        if(obj_ads.html !== '') {       
          var $html = $(obj_ads.html);
              $html.find('a').each(function(){
                    var me = $(this);
                    if(me.attr('href') !== ''){
                        me.attr('target','_blank');
                        me.bind('click',function(e){
                          $('body').append(obj_ads.click);
                        });
                        
                    }
              });
          var $c = $('*[data-uuid="'+obj_ads.uuid+'"]');
          if($c.length === 0) {
             $c =  $('*[data-uuid="'+obj_ads.uuid+'"]',window.parent.document);       
          }
          if($c.length > 0) {             
            $c.append(obj_ads.style);
            var $css = $("#bnextmedia_css",window.parent.document);       
            if($css.length === 0) {
                $c.append(obj_ads.css);  
            }                
            if(obj_ads.is_dialog) {
                var flag = true;
                if(obj_ads.expired_time > 0) {
                    var cookKey='bnextmedia_cover';
                    var check =  getCookie(cookKey);
                    if(check ==='yes') {
                        flag = false;                     
                    } else {
                        setCookie(cookKey, 'yes', obj_ads.expired_time);                    
                    }                    
                }
                if(flag) {                
                    if(obj_ads.is_native) {
                        $c.append($html.getBnextDialog(function(){
                            $c.remove();
                        }));           
                    } else {
                       var $dialog =  $html.getBnextDialog(function(){
                            $c.remove();
                        }, true);
                        $c.append($dialog);                  
                        setTimeout(function(){
                           $dialog.css('visibility','visible');
                        },3000)
                    }
                }
            } else {
                if(obj_ads.is_native) {
                    $c.append($html);
                } else {
		    var $iframe = $c.find('iframe');
		    $iframe.css({width:'100%'});
                    $('body').append($html);  
                    /*
                    $('body').bind('DOMSubtreeModified',function(){

                    });
                    */
                }
            }
          }
           if(obj_ads.is_native) {
                $('body').append(obj_ads.trace);
           }

        }    
        
        if(obj_ads.terms !== '') {
            $('body').attr('title',obj_ads.terms);
        }

        
    }());

